# Проект: Прогнозирование вероятности покупки в течение 90 дней

## Описание
Интернет-магазин собирает историю покупателей, проводит рекламные рассылки и планирует будущие продажи. Для оптимизации процессов необходимо выделить пользователей, которые готовы совершить покупку в ближайшие 90 дней.

## Цель
Построить модель для предсказания вероятности покупки в течение 90 дней.

## Задачи
- Изучить данные
- Разработать полезные признаки
- Создать модель для классификации пользователей
- Улучшить модель и максимизировать метрику ROC-AUC
- Выполнить тестирование модели

## Данные
Проект использует следующие исходные файлы:
- `apparel-messages.csv` — история рекламных рассылок
- `apparel-purchases.csv` — история покупок
- `apparel-target_binary.csv` — целевой признак (совершит ли клиент покупку в течение 90 дней)
- `full_campaign_daily_event.csv` — агрегированные данные по рассылкам по дням и типам событий
- `full_campaign_daily_event_channel.csv` — агрегированные данные по рассылкам по дням с учетом событий и каналов

## Структура проекта
1. **Загрузка и предварительный анализ данных**
   - Загрузка CSV-файлов
   - Обзор структуры и типов данных
   - Проверка на пропуски и дубликаты

2. **Исследовательский анализ данных (EDA)**
   - Статистическое описание данных
   - Визуализация распределений признаков
   - Анализ корреляций с помощью матрицы Phik

3. **Разработка признаков**
   - Создание новых признаков на основе исторических данных
   - Агрегация данных на уровне клиентов

4. **Подготовка данных к моделированию**
   - Обработка пропусков
   - Кодирование категориальных переменных
   - Масштабирование числовых признаков

5. **Обучение моделей**
   - Разделение данных на тренировочную и тестовую выборки
   - Обучение моделей:
     - Random Forest
     - K-Nearest Neighbors
     - Decision Tree
     - LightGBM
     - XGBoost
   - Оценка моделей с использованием кросс-валидации

6. **Оптимизация и тестирование**
   - Подбор гиперпараметров с помощью GridSearchCV и RandomizedSearchCV
   - Оценка лучшей модели на тестовой выборке
   - Интерпретация метрик: ROC-AUC, F1, Precision, Recall

## Используемые библиотеки
- `pandas`, `numpy` — обработка данных
- `matplotlib`, `seaborn` — визуализация
- `scikit-learn` — предобработка, моделирование, оценка
- `lightgbm`, `xgboost` — градиентный бустинг
- `phik` — анализ корреляций

## Установка и запуск
1. Клонируйте репозиторий:
   ```bash
   git clone <repository-url>
   ```
2. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
3. Запустите Jupyter Notebook:
   ```bash
   jupyter notebook Marketing_project.ipynb
   ```

## Результаты
В ходе проекта были обучены и протестированы несколько моделей машинного обучения. Лучшая модель была выбрана на основе метрики ROC-AUC. Результаты включают:
- Матрицу ошибок
- Отчет о классификации
- ROC-кривую и значение AUC
